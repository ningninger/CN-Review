# 路由基础

目标：在数据报网络中为交换机建立路由表，以及在虚电路网络中为建立选择连接选择路径和构建转发表

要求：

+ 效率：最小开销的路径
+ 韧性：应对峰值负载和交换机或线路故障
+ 稳定性：避免路由震荡



要素：

+ 性能准则
+ 决策时间
+ 决策位置
+ 网络信息来源
+ 网络信息更新机制



路由策略：

+ 集中式路由
+ 分布式路由
+ 泛洪式路由
+ 随机路由
+ 自适应路由



## 中央路由

+ 每个源和目的地对之间都确定了单一的固定路由
+ 使用最小路径算法来确定路由
+ 根据网络的拓扑的主要变化来重新配置



## 洪泛路由

+ 不需要任何网络信息
+ 数据包被交换给任何一个邻居
+ 目的地节点将会收到多个相同的数据包副本

+ 问题：
  + 重复
  + 循环
    + 限制跳数

+ 特性
  + 所有节点都被发送
    + 具有非常强的鲁棒性
  + 至少有一个数据包将采用最小成本路径
  + 可以用来建立虚拟电路
+ 所有交换机都被访问了
  + 可以用来分发信息（路由信息）



## 随机路由

+ 节点可以选择一条出站路径来转发接收到的数据包
  + 随机？轮询？基于概率计算？都可以
+ 不需要网络信息
+ 适合与强连通网络：保证数据包能够在网络中被转发到目的地
+ 路由通常不是最优的



为了进行随机路由选择：可以为每个出站路径分配概率值

概率值因素：传输速率（基于吞吐量）、队列大小（基于延迟）



## 自适应路由

+ 被几乎所有的分组交换网络使用
+ 路由随着网络条件的变化而动态调整路由决策
+ 需要关于网络状态的信息，并根据这些信息进行决策（在网络信息质量和开销之间权衡）
+ 可以实现拥塞控制



## 两种最短路径算法

### Djikstra

+ 找到最短路径从给定的源节点到其他的所有节点
+ 每次找到距离源节点的最小路径的节点，并将其加入一个最小生成树集中



复杂度：

正常：O（n^2^）

优先队列：O(nlog n)



可能发生震荡，不断重新计算最小路径



### Bellman-Ford

在这个算法中，一个节点将会问周围的节点它们到其他节点的路径，然后来估算出自己到其他节点的最短路径



+ 链路代价改变
  + 如果距离向量发生改变，节点会通知其邻居节点，这是因为在距离向量算法中的“好消息传的快”原则
+ “坏消息传的慢”---无限计数问题
  + 毒性逆转：发过节点A通过该节点B到达了C，A会告诉B，它到达C的距离是无限大
  + 解决了么？ 没有。毒性逆转对高于三个以上的环就没有用了



### 两种算法的比较

#### 基于Dijkstra的路由

+ 链路状态被洪泛到其他所有节点
+ 每个节点将具有完整的拓扑信息并构建自己的路由表
+ 无法处理负权重的问题



+ 消息复杂度：O(ne)
+ 收敛速度：O(n^2^)，虽然很快，但是可能会有震荡现象
+ 鲁棒性：如果一个节点发生路障，仅仅会影响邻居节点





#### 基于Bellman-ford的路由

+ 每个节点维护到其他已知节点的距离向量
+ 向直接邻居交换向量以更新路径和成本
+ 路由表在分布式方式构建



+ 消息复杂度：取决于收敛速度
+ 收敛速度：慢，且依赖与网络中的变化

+ 鲁棒性：错误会在网络中传播



### 路由算法的分类

+ 全局还是局部
  + 集中式算法：
    + 所有路由器都具有完整的拓扑和链路成本信息
  + 分散式算法：
    + 路由器只知道与其物理连接的邻居节点和链路代价
+ 静态还是动态
  + 静态：
    + 路由变化缓慢，很少发生变化
  + 动态：路由变化较快，可能是周期性更新或是响应链路成本的变化



