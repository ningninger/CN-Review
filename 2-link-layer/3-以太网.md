## 以太网

## 物理拓扑

+ 总线：在90年代中期就行
  + 所有节点都在同一个冲突域
+ 星形：今天流行
  + 主动交换中心





## 广播和交换

+ 以前广播
  + 主机共享信道
  + 每个数据包被所有连接的主机接收
  + 使用CSMA/CD进行介质访问控制

+ 现在交换
  + 交换机之间及主机与交换机之间是点对点连接
  + 没有共享->没有CSMA/CD，星形拓扑，基本有线以太网络基本不再需要碰撞检测
  + 没有“自学习“和“生成树”算法进行路由



 ## 可靠性与无连接

+ connectionless：在发送方和接收方的网络接口卡(NIC)之间没有握手过程
+ unreliable：接收方的NIC不会向发送方的NIC发送确认或否认(ACK or NACK)，只有当初始发送方使用更高层的可靠数据传输协议(例如TCP)，才能恢复丢失的帧中的数据；否则丢失的数据将无法恢复



## 以太网帧的格式

| 前导码（用于时钟同步+帧开始） | 目的MAC地址 | 发送方MAC地址 | 更高一层的协议类型 | DATA            | CRC     |
| ----------------------------- | ----------- | ------------- | ------------------ | --------------- | ------- |
| 7 bytes + 1bytes              | 6 bytes     | 6 bytes       | 2 bytes            | 46 ~ 1500 bytes | 4 bytes |



## MAC地址

被硬编码到网卡上的48位的地址



## 帧定界

物理层将帧放在链路上，但是连接在同一物理介质上的两个主机需要能够交换帧，这个功能由链路层提供的服务来实现，由网络适配器来实施

链路层需要能够识别帧的边界：帧定界

+ 简单的方法：比特定界（数比特）
  + 但是如果计数字段损坏了，需要使用CRC进行校验帧的完整性
  + 如果不完整则丢弃该帧，并且等待下一个帧处理，需要使用重传机制来确保在发生错误的时候能重新传输丢失的帧



+ 失步：帧定界错误
  + 一旦发生失步错误，它可能会持续存在
  + 使用“哨兵”比特模式来进行帧定界
    + 哨兵 == 特定的比特串（magic）
    + 使用哨兵模式可能出现误判帧边界
      + 解决方式：比特填充
      + 规则：发送方在连续五个1后插入0，接收方在连续5个1后的第一个0删除
      + 当接收方接收到5个1
        + 下一个是0：删除它
        + 下一个是1（也就是6个1）：如果在下一个0是帧开始，如果是1表示帧结束





